//////////////////////////////////////////////////////////////////////////////////////////////
// DO NOT MODIFY THIS FILE                                                                  //
// This file is automatically generated by ZenStack CLI and should not be manually updated. //
//////////////////////////////////////////////////////////////////////////////////////////////

datasource db {
    provider="mysql"
    url=env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
    previewFeatures = ["referentialIntegrity","fullTextSearch"]
}

enum ShowStatus {
    OPEND
    DRAFT
    REVIEW
}

enum ShopMemberRole {
    OWNER
    ADMIN
    SALER
}

enum ProduceStatus {
    IN_STOCK
    DRAFT
    REVIEW
}

enum ProduceType {
    CARD
    COMBO
    PHYSICAL
}

enum LimitBuyType {
    DAY
    WEEK
    MONTH
    ONCE
}

enum CardProduceAccountStatus {
    IN_STOCK
    SOLD
}

enum FreeExpressFeeRuleType {
    ORDER_AMOUNT_LIMIT
    ORDER_FEE_LIMIT
    PRODUCE_AMOUNT_LIMIT
    PRODUCE_FEE_LIMIT
}

enum ExpressFeeRuleTyle {
    AMOUNT
    WEIGHT
}

enum CurrencyType {
    AUD
    CAD
    CHF
    DKK
    EUR
    GBP
    HKD
    JPY
    KRW
    KZT
    MOP
    MYR
    NOK
    NZD
    PKR
    RUB
    SEK
    SGD
    THB
    USD
    ZAR
    PHP
    CNY
}

enum ConfigValueKey {
    TENCENT_COS_SECRET
    TENCENT_COS_UPLOAD
}

model User {
    id String @id() @default(cuid())
    name String?
    email String? @unique()
    emailVerified DateTime?
    image String?
    phone String?
    role String?
    accounts Account[]
    sessions Session[]
    password String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt()
    deletedAt DateTime?
    deleted Boolean @default(false)
    block Boolean @default(false)
    inviterId String?
    inviter User? @relation("InviteHistory", fields: [inviterId], references: [id])
    invitee User[] @relation("InviteHistory")
    shops Shop[]
    producs Produce[]
    produceSpecifications ProduceSpecification[]
    freeExpressFeeRules FreeExpressFeeRule[]
    expressFeeRules ExpressFeeRule[]
    shopMembers ShopMember[]
    i18nValues I18nValue[]
    configValues ConfigValue[]
    loginLogs LoginLog[]
    balanceLogs BalanceLog[]
    creatorBalanceLogs BalanceLog[] @relation("BalanceLogCreator")
}

model Account {
    userId String
    type String
    provider String
    providerAccountId String
    refresh_token String?
    access_token String?
    expires_at Int?
    token_type String?
    scope String?
    id_token String?
    session_state String?
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@id([provider, providerAccountId])
}

model Session {
    sessionToken String @unique()
    userId String
    expires DateTime
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
    identifier String
    token String @unique()
    expires DateTime

    @@id([identifier, token])
}

model LoginLog {
    day String
    userId String
    startAt DateTime @default(now())
    endAt DateTime
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@id([day, userId])
}

model BalanceLog {
    id String @id() @default(cuid())
    balance Decimal @default(0)
    change Decimal @default(0)
    changeBefore Decimal @default(0)
    remark String
    log Json?
    createdAt DateTime @default(now())
    creatorId String?
    creator User? @relation("BalanceLogCreator", fields: [creatorId], references: [id])
    preBalanceLogId String?
    preBalanceLog BalanceLog? @relation("BalanceLogHistory", fields: [preBalanceLogId], references: [id])
    balanceLogs BalanceLog[] @relation("BalanceLogHistory")
    userId String
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

/// @@allow('all', auth() == creator)
/// @@allow('read', auth() != null && published)
model Shop {
    id String @id() @default(cuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt()
    deletedAt DateTime?
    creator User? @relation(fields: [creatorId], references: [id])
    creatorId String?
    deleted Boolean @default(false)
    published Boolean @default(false)
    name String
    logo String?
    status ShowStatus @default(DRAFT)
    producs Produce[]
    shopMember ShopMember[]
}

model ShopMember {
    role ShopMemberRole
    shopId String
    shop Shop @relation(fields: [shopId], references: [id], onDelete: Cascade)
    userId String
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@id([shopId, userId])
}

/// @@allow('all', auth() == creator)
/// @@allow('read', auth() != null && published)
model ProduceSpecification {
    id String @id() @default(cuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt()
    deletedAt DateTime?
    creator User? @relation(fields: [creatorId], references: [id])
    creatorId String?
    deleted Boolean @default(false)
    published Boolean @default(false)
    name String
    values ProduceSpecificationValue[]
    producId String
    produc Produce @relation(fields: [producId], references: [id], onDelete: Cascade)
}

model ProduceSpecificationValue {
    id String @id() @default(cuid())
    value String
    iamge String?
    produceSpecificationId String
    produceSpecification ProduceSpecification @relation(fields: [produceSpecificationId], references: [id], onDelete: Cascade)
    producePrices ProducePrice[]
    produceSpecificationValuePrice ProduceSpecificationValuePrice[]
    deletedAt DateTime?
    deleted Boolean @default(false)
}

model ProducePrice {
    id String @id() @default(cuid())
    goods_no String?
    currency CurrencyType @default(CNY)
    price Decimal @default(0)
    cost Decimal @default(0)
    weight Int @default(0)
    stock Int @default(0)
    reduceStock Int
    saled Int @default(0)
    saledAmount Decimal @default(0)
    deletedAt DateTime?
    deleted Boolean @default(false)
    producId String
    produc Produce @relation(fields: [producId], references: [id], onDelete: Cascade)
    produceSpecificationValues ProduceSpecificationValue[]
    produceSpecificationValuePrice ProduceSpecificationValuePrice[]
}

model ProduceSpecificationValuePrice {
    producePriceId String
    producePrice ProducePrice @relation(fields: [producePriceId], references: [id])
    produceSpecificationValueId String
    produceSpecificationValue ProduceSpecificationValue @relation(fields: [produceSpecificationValueId], references: [id])

    @@id([producePriceId, produceSpecificationValueId])
}

/// @@allow('all', auth() == creator)
/// @@allow('read', auth() != null && published)
model Produce {
    id String @id() @default(cuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt()
    deletedAt DateTime?
    creator User? @relation(fields: [creatorId], references: [id])
    creatorId String?
    deleted Boolean @default(false)
    published Boolean @default(false)
    name String
    status ProduceStatus @default(DRAFT)
    linePrice Decimal
    tags String?
    visits Int @default(0)
    saled Int @default(0)
    saledAmount Decimal @default(0)
    isLimitBuy Boolean @default(false)
    limitBuyType LimitBuyType?
    limitBuyValue Int?
    minBuyValue Int?
    shopId String
    shop Shop @relation(fields: [shopId], references: [id], onDelete: Cascade)
    produceSpecification ProduceSpecification[]
    producePrice ProducePrice[]
    type ProduceType @default(PHYSICAL)
    cardProduce CardProduce?
    comboProduce ComboProduce?
    physicalProduce PhysicalProduce?
}

model CardProduceAccount {
    id String @id() @default(cuid())
    value String
    status CardProduceAccountStatus @default(IN_STOCK)
    cardProduceId String
    cardProduce CardProduce @relation(fields: [cardProduceId], references: [id], onDelete: Cascade)
}

model CardProduce {
    id String @id() @default(cuid())
    produceId String @unique()
    produce Produce @relation(fields: [produceId], references: [id], onDelete: Cascade)
    cardProduceAccounts CardProduceAccount[]
}

model ComboProduce {
    id String @id() @default(cuid())
    produceId String @unique()
    produce Produce @relation(fields: [produceId], references: [id], onDelete: Cascade)
}

/// @@allow('all', auth() == creator)
/// @@allow('read', auth() != null && published)
model FreeExpressFeeRule {
    id String @id() @default(cuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt()
    deletedAt DateTime?
    creator User? @relation(fields: [creatorId], references: [id])
    creatorId String?
    deleted Boolean @default(false)
    published Boolean @default(false)
    name String
    type FreeExpressFeeRuleType @default(ORDER_FEE_LIMIT)
    freeExpressFeeRuleCitys FreeExpressFeeRuleCity[]
    physicalProduces PhysicalProduce[]
    isDef Boolean
}

model FreeExpressFeeRuleCity {
    id String @id() @default(cuid())
    citys String
    limit Int
    freeExpressFeeRuleId String
    freeExpressFeeRule FreeExpressFeeRule @relation(fields: [freeExpressFeeRuleId], references: [id], onDelete: Cascade)
}

/// @@allow('all', auth() == creator)
/// @@allow('read', auth() != null && published)
model ExpressFeeRule {
    id String @id() @default(cuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt()
    deletedAt DateTime?
    creator User? @relation(fields: [creatorId], references: [id])
    creatorId String?
    deleted Boolean @default(false)
    published Boolean @default(false)
    name String
    type ExpressFeeRuleTyle @default(AMOUNT)
    isDef Boolean
    expressFeeRuleCitys ExpressFeeRuleCity[]
    physicalProduces PhysicalProduce[]
}

model ExpressFeeRuleCity {
    id String @id() @default(cuid())
    citys String
    firstLimit Int
    firstFee Decimal
    step Int
    stepFee Decimal
    expressFeeRuleId String
    expressFeeRule ExpressFeeRule @relation(fields: [expressFeeRuleId], references: [id], onDelete: Cascade)
}

model PhysicalProduce {
    id String @id() @default(cuid())
    produceId String @unique()
    produce Produce @relation(fields: [produceId], references: [id], onDelete: Cascade)
    expressFee Decimal
    isFreeExpressFee Boolean
    freeExpressFeeRuleId String
    freeExpressFeeRule FreeExpressFeeRule @relation(fields: [freeExpressFeeRuleId], references: [id], onDelete: Cascade)
    expressFeeRuleId String
    expressFeeRule ExpressFeeRule @relation(fields: [expressFeeRuleId], references: [id], onDelete: Cascade)
}

/// @@allow('all', auth() == creator)
/// @@allow('read', auth() != null && published)
model I18nValue {
    id String @id() @default(cuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt()
    deletedAt DateTime?
    creator User? @relation(fields: [creatorId], references: [id])
    creatorId String?
    deleted Boolean @default(false)
    published Boolean @default(false)
    key String
    value String
    lang String
}

/// @@allow('all', auth() == creator)
/// @@allow('read', auth() != null && published)
model ConfigValue {
    id String @id() @default(cuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt()
    deletedAt DateTime?
    creator User? @relation(fields: [creatorId], references: [id])
    creatorId String?
    deleted Boolean @default(false)
    published Boolean @default(false)
    key ConfigValueKey
    value Json
}